In statistics, canonical-correlation analysis (CCA), also called canonical variates analysis, is a way of inferring information from cross-covariance matrices. If we have two vectors X = (X1, ..., Xn) and Y = (Y1, ..., Ym)  of random variables, and there are correlations among the variables, then canonical-correlation analysis will find linear combinations of X and Y which have maximum correlation with each other. T. R. Knapp notes that "virtually all of the commonly encountered parametric tests of significance can be treated as special cases of canonical-correlation analysis, which is the general procedure for investigating the relationships between two sets of variables." The method was first introduced by Harold Hotelling in 1936, although in the context of angles between flats the mathematical concept was published by Jordan in 1875.\n\n\n== Definition ==\nGiven two column vectors \n  \n    \n      \n        X\n        =\n        (\n        \n          x\n          \n            1\n          \n        \n        ,\n        \u2026\n        ,\n        \n          x\n          \n            n\n          \n        \n        \n          )\n          \u2032\n        \n      \n    \n    {\\displaystyle X=(x_{1},\\dots ,x_{n})'}\n   and \n  \n    \n      \n        Y\n        =\n        (\n        \n          y\n          \n            1\n          \n        \n        ,\n        \u2026\n        ,\n        \n          y\n          \n            m\n          \n        \n        \n          )\n          \u2032\n        \n      \n    \n    {\\displaystyle Y=(y_{1},\\dots ,y_{m})'}\n   of random variables with finite second moments, one may define the cross-covariance \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        =\n        cov\n        \u2061\n        (\n        X\n        ,\n        Y\n        )\n      \n    \n    {\\displaystyle \\Sigma _{XY}=\\operatorname {cov} (X,Y)}\n   to be the \n  \n    \n      \n        n\n        \xd7\n        m\n      \n    \n    {\\displaystyle n\\times m}\n   matrix whose \n  \n    \n      \n        (\n        i\n        ,\n        j\n        )\n      \n    \n    {\\displaystyle (i,j)}\n   entry is the covariance \n  \n    \n      \n        cov\n        \u2061\n        (\n        \n          x\n          \n            i\n          \n        \n        ,\n        \n          y\n          \n            j\n          \n        \n        )\n      \n    \n    {\\displaystyle \\operatorname {cov} (x_{i},y_{j})}\n  . In practice, we would estimate the covariance matrix based on sampled data from \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   (i.e. from a pair of data matrices).\nCanonical-correlation analysis seeks vectors \n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n    (\n  \n    \n      \n        a\n        \u2208\n        \n          \n            R\n          \n          \n            n\n          \n        \n      \n    \n    {\\displaystyle a\\in \\mathbb {R} ^{n}}\n  ) and \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n   (\n  \n    \n      \n        b\n        \u2208\n        \n          \n            R\n          \n          \n            m\n          \n        \n      \n    \n    {\\displaystyle b\\in \\mathbb {R} ^{m}}\n  ) such that the random variables \n  \n    \n      \n        \n          a\n          \n            T\n          \n        \n        X\n      \n    \n    {\\displaystyle a^{T}X}\n   and \n  \n    \n      \n        \n          b\n          \n            T\n          \n        \n        Y\n      \n    \n    {\\displaystyle b^{T}Y}\n   maximize the correlation \n  \n    \n      \n        \u03c1\n        =\n        corr\n        \u2061\n        (\n        \n          a\n          \n            T\n          \n        \n        X\n        ,\n        \n          b\n          \n            T\n          \n        \n        Y\n        )\n      \n    \n    {\\displaystyle \\rho =\\operatorname {corr} (a^{T}X,b^{T}Y)}\n  . The random variables \n  \n    \n      \n        U\n        =\n        \n          a\n          \n            T\n          \n        \n        X\n      \n    \n    {\\displaystyle U=a^{T}X}\n   and \n  \n    \n      \n        V\n        =\n        \n          b\n          \n            T\n          \n        \n        Y\n      \n    \n    {\\displaystyle V=b^{T}Y}\n   are the first pair of canonical variables. Then one seeks vectors maximizing the same correlation subject to the constraint that they are to be uncorrelated with the first pair of canonical variables; this gives the second pair of canonical variables. This procedure may be continued up to \n  \n    \n      \n        min\n        {\n        m\n        ,\n        n\n        }\n      \n    \n    {\\displaystyle \\min\\{m,n\\}}\n   times.\n\n\n== Computation ==\n\n\n=== Derivation ===\nLet \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n        \n        =\n        cov\n        \u2061\n        (\n        X\n        ,\n        X\n        )\n      \n    \n    {\\displaystyle \\Sigma _{XX}=\\operatorname {cov} (X,X)}\n   and \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n        \n        =\n        cov\n        \u2061\n        (\n        Y\n        ,\n        Y\n        )\n      \n    \n    {\\displaystyle \\Sigma _{YY}=\\operatorname {cov} (Y,Y)}\n  . The parameter to maximize is\n\n  \n    \n      \n        \u03c1\n        =\n        \n          \n            \n              \n                a\n                \n                  T\n                \n              \n              \n                \u03a3\n                \n                  X\n                  Y\n                \n              \n              b\n            \n            \n              \n                \n                  \n                    a\n                    \n                      T\n                    \n                  \n                  \n                    \u03a3\n                    \n                      X\n                      X\n                    \n                  \n                  a\n                \n              \n              \n                \n                  \n                    b\n                    \n                      T\n                    \n                  \n                  \n                    \u03a3\n                    \n                      Y\n                      Y\n                    \n                  \n                  b\n                \n              \n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\rho ={\\frac {a^{T}\\Sigma _{XY}b}{{\\sqrt {a^{T}\\Sigma _{XX}a}}{\\sqrt {b^{T}\\Sigma _{YY}b}}}}.}\n  The first step is to define a change of basis and define\n\n  \n    \n      \n        c\n        =\n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            1\n            \n              /\n            \n            2\n          \n        \n        a\n        ,\n      \n    \n    {\\displaystyle c=\\Sigma _{XX}^{1/2}a,}\n  \n  \n    \n      \n        d\n        =\n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            1\n            \n              /\n            \n            2\n          \n        \n        b\n        .\n      \n    \n    {\\displaystyle d=\\Sigma _{YY}^{1/2}b.}\n  And thus we have\n\n  \n    \n      \n        \u03c1\n        =\n        \n          \n            \n              \n                c\n                \n                  T\n                \n              \n              \n                \u03a3\n                \n                  X\n                  X\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              \n                \u03a3\n                \n                  X\n                  Y\n                \n              \n              \n                \u03a3\n                \n                  Y\n                  Y\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              d\n            \n            \n              \n                \n                  \n                    c\n                    \n                      T\n                    \n                  \n                  c\n                \n              \n              \n                \n                  \n                    d\n                    \n                      T\n                    \n                  \n                  d\n                \n              \n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\rho ={\\frac {c^{T}\\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1/2}d}{{\\sqrt {c^{T}c}}{\\sqrt {d^{T}d}}}}.}\n  By the Cauchy\u2013Schwarz inequality, we have\n\n  \n    \n      \n        \n          (\n          \n            \n              c\n              \n                T\n              \n            \n            \n              \u03a3\n              \n                X\n                X\n              \n              \n                \u2212\n                1\n                \n                  /\n                \n                2\n              \n            \n            \n              \u03a3\n              \n                X\n                Y\n              \n            \n            \n              \u03a3\n              \n                Y\n                Y\n              \n              \n                \u2212\n                1\n                \n                  /\n                \n                2\n              \n            \n          \n          )\n        \n        (\n        d\n        )\n        \u2264\n        \n          \n            (\n            \n              \n                c\n                \n                  T\n                \n              \n              \n                \u03a3\n                \n                  X\n                  X\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              \n                \u03a3\n                \n                  X\n                  Y\n                \n              \n              \n                \u03a3\n                \n                  Y\n                  Y\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              \n                \u03a3\n                \n                  Y\n                  Y\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              \n                \u03a3\n                \n                  Y\n                  X\n                \n              \n              \n                \u03a3\n                \n                  X\n                  X\n                \n                \n                  \u2212\n                  1\n                  \n                    /\n                  \n                  2\n                \n              \n              c\n            \n            )\n          \n          \n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \n            (\n            \n              \n                d\n                \n                  T\n                \n              \n              d\n            \n            )\n          \n          \n            1\n            \n              /\n            \n            2\n          \n        \n        ,\n      \n    \n    {\\displaystyle \\left(c^{T}\\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1/2}\\right)(d)\\leq \\left(c^{T}\\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1/2}\\Sigma _{YY}^{-1/2}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}c\\right)^{1/2}\\left(d^{T}d\\right)^{1/2},}\n  \n  \n    \n      \n        \u03c1\n        \u2264\n        \n          \n            \n              \n                (\n                \n                  \n                    c\n                    \n                      T\n                    \n                  \n                  \n                    \u03a3\n                    \n                      X\n                      X\n                    \n                    \n                      \u2212\n                      1\n                      \n                        /\n                      \n                      2\n                    \n                  \n                  \n                    \u03a3\n                    \n                      X\n                      Y\n                    \n                  \n                  \n                    \u03a3\n                    \n                      Y\n                      Y\n                    \n                    \n                      \u2212\n                      1\n                    \n                  \n                  \n                    \u03a3\n                    \n                      Y\n                      X\n                    \n                  \n                  \n                    \u03a3\n                    \n                      X\n                      X\n                    \n                    \n                      \u2212\n                      1\n                      \n                        /\n                      \n                      2\n                    \n                  \n                  c\n                \n                )\n              \n              \n                1\n                \n                  /\n                \n                2\n              \n            \n            \n              \n                (\n                \n                  \n                    c\n                    \n                      T\n                    \n                  \n                  c\n                \n                )\n              \n              \n                1\n                \n                  /\n                \n                2\n              \n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\rho \\leq {\\frac {\\left(c^{T}\\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}c\\right)^{1/2}}{\\left(c^{T}c\\right)^{1/2}}}.}\n  There is equality if the vectors \n  \n    \n      \n        d\n      \n    \n    {\\displaystyle d}\n   and \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        c\n      \n    \n    {\\displaystyle \\Sigma _{YY}^{-1/2}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}c}\n   are collinear. In addition, the maximum of correlation is attained if \n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n   is the eigenvector with the maximum eigenvalue for the matrix \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n      \n    \n    {\\displaystyle \\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}}\n   (see Rayleigh quotient). The subsequent pairs are found by using eigenvalues of decreasing magnitudes. Orthogonality is guaranteed by the symmetry of the correlation matrices.\nAnother way of viewing this computation is that \n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n   and \n  \n    \n      \n        d\n      \n    \n    {\\displaystyle d}\n   are the left and right singular vectors of the correlation matrix of X and Y corresponding to the highest singular value.\n\n\n=== Solution ===\nThe solution is therefore:\n\n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n   is an eigenvector of \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n      \n    \n    {\\displaystyle \\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}}\n  \n\n  \n    \n      \n        d\n      \n    \n    {\\displaystyle d}\n   is proportional to \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        c\n      \n    \n    {\\displaystyle \\Sigma _{YY}^{-1/2}\\Sigma _{YX}\\Sigma _{XX}^{-1/2}c}\n  Reciprocally, there is also:\n\n  \n    \n      \n        d\n      \n    \n    {\\displaystyle d}\n   is an eigenvector of \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n      \n    \n    {\\displaystyle \\Sigma _{YY}^{-1/2}\\Sigma _{YX}\\Sigma _{XX}^{-1}\\Sigma _{XY}\\Sigma _{YY}^{-1/2}}\n  \n\n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n   is proportional to \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        d\n      \n    \n    {\\displaystyle \\Sigma _{XX}^{-1/2}\\Sigma _{XY}\\Sigma _{YY}^{-1/2}d}\n  Reversing the change of coordinates, we have that\n\n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n   is an eigenvector of \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n      \n    \n    {\\displaystyle \\Sigma _{XX}^{-1}\\Sigma _{XY}\\Sigma _{YY}^{-1}\\Sigma _{YX}}\n  ,\n\n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n   is proportional to \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        a\n        ;\n      \n    \n    {\\displaystyle \\Sigma _{YY}^{-1}\\Sigma _{YX}a;}\n  \n\n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n   is an eigenvector of \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            Y\n            X\n          \n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        ,\n      \n    \n    {\\displaystyle \\Sigma _{YY}^{-1}\\Sigma _{YX}\\Sigma _{XX}^{-1}\\Sigma _{XY},}\n  \n\n  \n    \n      \n        a\n      \n    \n    {\\displaystyle a}\n   is proportional to \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n          \n        \n        \n          \u03a3\n          \n            X\n            Y\n          \n        \n        b\n      \n    \n    {\\displaystyle \\Sigma _{XX}^{-1}\\Sigma _{XY}b}\n  .The canonical variables are defined by:\n\n  \n    \n      \n        U\n        =\n        \n          c\n          \u2032\n        \n        \n          \u03a3\n          \n            X\n            X\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        X\n        =\n        \n          a\n          \u2032\n        \n        X\n      \n    \n    {\\displaystyle U=c'\\Sigma _{XX}^{-1/2}X=a'X}\n  \n  \n    \n      \n        V\n        =\n        \n          d\n          \u2032\n        \n        \n          \u03a3\n          \n            Y\n            Y\n          \n          \n            \u2212\n            1\n            \n              /\n            \n            2\n          \n        \n        Y\n        =\n        \n          b\n          \u2032\n        \n        Y\n      \n    \n    {\\displaystyle V=d'\\Sigma _{YY}^{-1/2}Y=b'Y}\n  \n\n\n=== Implementation ===\nCCA can be computed using singular value decomposition on a correlation matrix. It is available as a function in\nMATLAB as canoncorr (also in Octave)\nR as the standard function cancor and several other packages, including CCA and vegan. CCP for statistical hypothesis testing in canonical correlation analysis.\nSAS as proc cancorr\nPython in the library scikit-learn, as Cross decomposition and in statsmodels, as CanCorr.\nSPSS as macro CanCorr shipped with the main software\nJulia (programming language) in the MultivariateStats.jl package.CCA computation using singular value decomposition on a correlation matrix is related to the cosine of the angles between flats. The cosine function is ill-conditioned for small angles, leading to very inaccurate computation of highly correlated principal vectors in finite precision computer arithmetic. To  fix this trouble, alternative algorithms are available in\n\nSciPy as linear-algebra function subspace_angles\nMATLAB as FileExchange function subspacea\n\n\n== Hypothesis testing ==\nEach row can be tested for significance with the following method. Since the correlations are sorted, saying that row \n  \n    \n      \n        i\n      \n    \n    {\\displaystyle i}\n   is zero implies all further correlations are also zero.  If we have \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n   independent observations in a sample and \n  \n    \n      \n        \n          \n            \n              \n                \u03c1\n                ^\n              \n            \n          \n          \n            i\n          \n        \n      \n    \n    {\\displaystyle {\\widehat {\\rho }}_{i}}\n   is the estimated correlation for \n  \n    \n      \n        i\n        =\n        1\n        ,\n        \u2026\n        ,\n        min\n        {\n        m\n        ,\n        n\n        }\n      \n    \n    {\\displaystyle i=1,\\dots ,\\min\\{m,n\\}}\n  . For the \n  \n    \n      \n        i\n      \n    \n    {\\displaystyle i}\n  th row, the test statistic is:\n\n  \n    \n      \n        \n          \u03c7\n          \n            2\n          \n        \n        =\n        \u2212\n        \n          (\n          \n            p\n            \u2212\n            1\n            \u2212\n            \n              \n                1\n                2\n              \n            \n            (\n            m\n            +\n            n\n            +\n            1\n            )\n          \n          )\n        \n        ln\n        \u2061\n        \n          \u220f\n          \n            j\n            =\n            i\n          \n          \n            min\n            {\n            m\n            ,\n            n\n            }\n          \n        \n        (\n        1\n        \u2212\n        \n          \n            \n              \n                \u03c1\n                ^\n              \n            \n          \n          \n            j\n          \n          \n            2\n          \n        \n        )\n        ,\n      \n    \n    {\\displaystyle \\chi ^{2}=-\\left(p-1-{\\frac {1}{2}}(m+n+1)\\right)\\ln \\prod _{j=i}^{\\min\\{m,n\\}}(1-{\\widehat {\\rho }}_{j}^{2}),}\n  which is asymptotically distributed as a chi-squared with \n  \n    \n      \n        (\n        m\n        \u2212\n        i\n        +\n        1\n        )\n        (\n        n\n        \u2212\n        i\n        +\n        1\n        )\n      \n    \n    {\\displaystyle (m-i+1)(n-i+1)}\n   degrees of freedom for large \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  .  Since all the correlations from \n  \n    \n      \n        min\n        {\n        m\n        ,\n        n\n        }\n      \n    \n    {\\displaystyle \\min\\{m,n\\}}\n   to \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n   are logically zero (and estimated that way also) the product for the terms after this point is irrelevant.\nNote that in the small sample size limit with \n  \n    \n      \n        p\n        <\n        n\n        +\n        m\n      \n    \n    {\\displaystyle p<n+m}\n   then we are guaranteed that the top \n  \n    \n      \n        m\n        +\n        n\n        \u2212\n        p\n      \n    \n    {\\displaystyle m+n-p}\n   correlations will be identically 1 and hence the test is meaningless.\n\n\n== Practical uses ==\nA typical use for canonical correlation in the experimental context is to take two sets of variables and see what is common among the two sets. For example, in psychological testing, one could take two well established multidimensional personality tests such as the Minnesota Multiphasic Personality Inventory (MMPI-2) and the NEO. By seeing how the MMPI-2 factors relate to the NEO factors, one could gain insight into what dimensions were common between the tests and how much variance was shared. For example, one might find that an extraversion or neuroticism dimension accounted for a substantial amount of shared variance between the two tests.\nOne can also use canonical-correlation analysis to produce a model equation which relates two sets of variables, for example a set of performance measures and a set of explanatory variables, or a set of outputs and set of inputs. Constraint restrictions can be imposed on such a model to ensure it reflects theoretical requirements or intuitively obvious conditions. This type of model is known as a maximum correlation model.Visualization of the results of canonical correlation is usually through bar plots of the coefficients of the two sets of variables for the pairs of canonical variates showing significant correlation. Some authors suggest that they are best visualized by plotting them as heliographs, a circular format with ray like bars, with each half representing the two sets of variables.\n\n\n== Examples ==\nLet \n  \n    \n      \n        X\n        =\n        \n          x\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle X=x_{1}}\n   with zero expected value, i.e., \n  \n    \n      \n        E\n        \u2061\n        (\n        X\n        )\n        =\n        0\n      \n    \n    {\\displaystyle \\operatorname {E} (X)=0}\n  . If \n  \n    \n      \n        Y\n        =\n        X\n      \n    \n    {\\displaystyle Y=X}\n  , i.e., \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   are perfectly correlated, then, e.g., \n  \n    \n      \n        a\n        =\n        1\n      \n    \n    {\\displaystyle a=1}\n   and \n  \n    \n      \n        b\n        =\n        1\n      \n    \n    {\\displaystyle b=1}\n  , so that the first (and only in this example) pair of canonical variables is \n  \n    \n      \n        U\n        =\n        X\n      \n    \n    {\\displaystyle U=X}\n   and \n  \n    \n      \n        V\n        =\n        Y\n        =\n        X\n      \n    \n    {\\displaystyle V=Y=X}\n  . If \n  \n    \n      \n        Y\n        =\n        \u2212\n        X\n      \n    \n    {\\displaystyle Y=-X}\n  , i.e., \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   are perfectly anticorrelated, then, e.g., \n  \n    \n      \n        a\n        =\n        1\n      \n    \n    {\\displaystyle a=1}\n   and \n  \n    \n      \n        b\n        =\n        \u2212\n        1\n      \n    \n    {\\displaystyle b=-1}\n  , so that the first (and only in this example) pair of canonical variables is \n  \n    \n      \n        U\n        =\n        X\n      \n    \n    {\\displaystyle U=X}\n   and \n  \n    \n      \n        V\n        =\n        \u2212\n        Y\n        =\n        X\n      \n    \n    {\\displaystyle V=-Y=X}\n  . We notice that in both cases \n  \n    \n      \n        U\n        =\n        V\n      \n    \n    {\\displaystyle U=V}\n  , which illustrates that the canonical-correlation analysis treats correlated and anticorrelated variables similarly.\n\n\n== Connection to principal angles ==\nAssuming that \n  \n    \n      \n        X\n        =\n        (\n        \n          x\n          \n            1\n          \n        \n        ,\n        \u2026\n        ,\n        \n          x\n          \n            n\n          \n        \n        \n          )\n          \u2032\n        \n      \n    \n    {\\displaystyle X=(x_{1},\\dots ,x_{n})'}\n   and \n  \n    \n      \n        Y\n        =\n        (\n        \n          y\n          \n            1\n          \n        \n        ,\n        \u2026\n        ,\n        \n          y\n          \n            m\n          \n        \n        \n          )\n          \u2032\n        \n      \n    \n    {\\displaystyle Y=(y_{1},\\dots ,y_{m})'}\n   have zero expected values, i.e., \n  \n    \n      \n        E\n        \u2061\n        (\n        X\n        )\n        =\n        E\n        \u2061\n        (\n        Y\n        )\n        =\n        0\n      \n    \n    {\\displaystyle \\operatorname {E} (X)=\\operatorname {E} (Y)=0}\n  , their covariance  matrices \n  \n    \n      \n        \n          \u03a3\n          \n            X\n            X\n          \n        \n        =\n        Cov\n        \u2061\n        (\n        X\n        ,\n        X\n        )\n        =\n        E\n        \u2061\n        [\n        X\n        \n          X\n          \u2032\n        \n        ]\n      \n    \n    {\\displaystyle \\Sigma _{XX}=\\operatorname {Cov} (X,X)=\\operatorname {E} [XX']}\n   and \n  \n    \n      \n        \n          \u03a3\n          \n            Y\n            Y\n          \n        \n        =\n        Cov\n        \u2061\n        (\n        Y\n        ,\n        Y\n        )\n        =\n        E\n        \u2061\n        [\n        Y\n        \n          Y\n          \u2032\n        \n        ]\n      \n    \n    {\\displaystyle \\Sigma _{YY}=\\operatorname {Cov} (Y,Y)=\\operatorname {E} [YY']}\n   can be viewed as Gram matrices in an inner product for the entries of  \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n  , correspondingly. In this interpretation, the random variables, entries \n  \n    \n      \n        \n          x\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle x_{i}}\n   of  \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        \n          y\n          \n            j\n          \n        \n      \n    \n    {\\displaystyle y_{j}}\n   of \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   are treated as elements of a vector space with an inner product given by the covariance \n  \n    \n      \n        cov\n        \u2061\n        (\n        \n          x\n          \n            i\n          \n        \n        ,\n        \n          y\n          \n            j\n          \n        \n        )\n      \n    \n    {\\displaystyle \\operatorname {cov} (x_{i},y_{j})}\n  ; see Covariance#Relationship to inner products.\nThe definition of the canonical variables \n  \n    \n      \n        U\n      \n    \n    {\\displaystyle U}\n   and \n  \n    \n      \n        V\n      \n    \n    {\\displaystyle V}\n   is then equivalent to the definition of principal vectors for the pair of subspaces spanned by the entries of  \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   with respect to this  inner product. The canonical correlations \n  \n    \n      \n        corr\n        \u2061\n        (\n        U\n        ,\n        V\n        )\n      \n    \n    {\\displaystyle \\operatorname {corr} (U,V)}\n   is equal to the cosine of principal angles.\n\n\n== Whitening and probabilistic canonical correlation analysis ==\nCCA can also be viewed as a special whitening transformation where the random vectors \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n   and \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n   are simultaneously transformed in such a way that the cross-correlation between the whitened vectors \n  \n    \n      \n        \n          X\n          \n            C\n            C\n            A\n          \n        \n      \n    \n    {\\displaystyle X^{CCA}}\n   and \n  \n    \n      \n        \n          Y\n          \n            C\n            C\n            A\n          \n        \n      \n    \n    {\\displaystyle Y^{CCA}}\n   is diagonal.\nThe canonical correlations are then interpreted as regression coefficients linking \n  \n    \n      \n        \n          X\n          \n            C\n            C\n            A\n          \n        \n      \n    \n    {\\displaystyle X^{CCA}}\n   and \n  \n    \n      \n        \n          Y\n          \n            C\n            C\n            A\n          \n        \n      \n    \n    {\\displaystyle Y^{CCA}}\n   and may also be negative.  The regression view of CCA also provides a way to construct a latent variable probabilistic generative model for CCA, with uncorrelated hidden variables representing shared and non-shared variability.\n\n\n== See also ==\nGeneralized canonical correlation\nMultilinear subspace learning\nRV coefficient\nAngles between flats\nPrincipal component analysis\nLinear discriminant analysis\nRegularized canonical correlation analysis\nSingular-value decomposition\nPartial least squares regression\n\n\n== References ==\n\n\n== External links ==\nDiscriminant Correlation Analysis (DCA) (MATLAB)\nHardoon, D. R.; Szedmak, S.; Shawe-Taylor, J. (2004). "Canonical Correlation Analysis: An Overview with Application to Learning Methods". Neural Computation. 16 (12): 2639\u20132664. CiteSeerX 10.1.1.14.6452. doi:10.1162/0899766042321814. PMID 15516276.\nA note on the ordinal canonical-correlation analysis of two sets of ranking scores (Also provides a FORTRAN program)- in Journal of Quantitative Economics 7(2), 2009, pp. 173\u2013199\nRepresentation-Constrained Canonical Correlation Analysis: A Hybridization of Canonical Correlation and Principal Component Analyses (Also provides a FORTRAN program)- in Journal of Applied Economic Sciences 4(1), 2009, pp. 115\u2013124