In statistics, the use of Bayes factors is a Bayesian alternative to classical hypothesis testing. Bayesian model comparison is a method of model selection based on Bayes factors. The models under consideration are statistical models. The aim of the Bayes factor is to quantify the support for a model over another, regardless of whether these models are correct. The technical definition of "support" in the context of Bayesian inference is described below.\n\n\n== Definition ==\nThe Bayes factor is a likelihood ratio of the marginal likelihood of two competing hypotheses, usually a null and an alternative.The posterior probability \n  \n    \n      \n        Pr\n        (\n        M\n        \n          |\n        \n        D\n        )\n      \n    \n    {\\displaystyle \\Pr(M|D)}\n   of a model M given data D is given by Bayes' theorem:\n\n  \n    \n      \n        Pr\n        (\n        M\n        \n          |\n        \n        D\n        )\n        =\n        \n          \n            \n              Pr\n              (\n              D\n              \n                |\n              \n              M\n              )\n              Pr\n              (\n              M\n              )\n            \n            \n              Pr\n              (\n              D\n              )\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle \\Pr(M|D)={\\frac {\\Pr(D|M)\\Pr(M)}{\\Pr(D)}}.}\n  The key data-dependent term \n  \n    \n      \n        Pr\n        (\n        D\n        \n          |\n        \n        M\n        )\n      \n    \n    {\\displaystyle \\Pr(D|M)}\n   represents the probability that some data are produced under the assumption of the model M; evaluating it correctly is the key to Bayesian model comparison.\nGiven a model selection problem in which we have to choose between two models on the basis of observed data D, the plausibility of the two different models M1 and M2, parametrised by model parameter vectors \n  \n    \n      \n        \n          \u03b8\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\theta _{1}}\n   and \n  \n    \n      \n        \n          \u03b8\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\theta _{2}}\n  , is assessed by the Bayes factor K given by\n\n  \n    \n      \n        K\n        =\n        \n          \n            \n              Pr\n              (\n              D\n              \n                |\n              \n              \n                M\n                \n                  1\n                \n              \n              )\n            \n            \n              Pr\n              (\n              D\n              \n                |\n              \n              \n                M\n                \n                  2\n                \n              \n              )\n            \n          \n        \n        =\n        \n          \n            \n              \u222b\n              Pr\n              (\n              \n                \u03b8\n                \n                  1\n                \n              \n              \n                |\n              \n              \n                M\n                \n                  1\n                \n              \n              )\n              Pr\n              (\n              D\n              \n                |\n              \n              \n                \u03b8\n                \n                  1\n                \n              \n              ,\n              \n                M\n                \n                  1\n                \n              \n              )\n              \n              d\n              \n                \u03b8\n                \n                  1\n                \n              \n            \n            \n              \u222b\n              Pr\n              (\n              \n                \u03b8\n                \n                  2\n                \n              \n              \n                |\n              \n              \n                M\n                \n                  2\n                \n              \n              )\n              Pr\n              (\n              D\n              \n                |\n              \n              \n                \u03b8\n                \n                  2\n                \n              \n              ,\n              \n                M\n                \n                  2\n                \n              \n              )\n              \n              d\n              \n                \u03b8\n                \n                  2\n                \n              \n            \n          \n        \n        =\n        \n          \n            \n              \n                Pr\n                (\n                \n                  M\n                  \n                    1\n                  \n                \n                \n                  |\n                \n                D\n                )\n                Pr\n                (\n                D\n                )\n              \n              \n                Pr\n                (\n                \n                  M\n                  \n                    1\n                  \n                \n                )\n              \n            \n            \n              \n                Pr\n                (\n                \n                  M\n                  \n                    2\n                  \n                \n                \n                  |\n                \n                D\n                )\n                Pr\n                (\n                D\n                )\n              \n              \n                Pr\n                (\n                \n                  M\n                  \n                    2\n                  \n                \n                )\n              \n            \n          \n        \n        =\n        \n          \n            \n              Pr\n              (\n              \n                M\n                \n                  1\n                \n              \n              \n                |\n              \n              D\n              )\n            \n            \n              Pr\n              (\n              \n                M\n                \n                  2\n                \n              \n              \n                |\n              \n              D\n              )\n            \n          \n        \n        \n          \n            \n              Pr\n              (\n              \n                M\n                \n                  2\n                \n              \n              )\n            \n            \n              Pr\n              (\n              \n                M\n                \n                  1\n                \n              \n              )\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle K={\\frac {\\Pr(D|M_{1})}{\\Pr(D|M_{2})}}={\\frac {\\int \\Pr(\\theta _{1}|M_{1})\\Pr(D|\\theta _{1},M_{1})\\,d\\theta _{1}}{\\int \\Pr(\\theta _{2}|M_{2})\\Pr(D|\\theta _{2},M_{2})\\,d\\theta _{2}}}={\\frac {\\frac {\\Pr(M_{1}|D)\\Pr(D)}{\\Pr(M_{1})}}{\\frac {\\Pr(M_{2}|D)\\Pr(D)}{\\Pr(M_{2})}}}={\\frac {\\Pr(M_{1}|D)}{\\Pr(M_{2}|D)}}{\\frac {\\Pr(M_{2})}{\\Pr(M_{1})}}.}\n  When the two models are equally probable a priori, so that \n  \n    \n      \n        Pr\n        (\n        \n          M\n          \n            1\n          \n        \n        )\n        =\n        Pr\n        (\n        \n          M\n          \n            2\n          \n        \n        )\n      \n    \n    {\\displaystyle \\Pr(M_{1})=\\Pr(M_{2})}\n  , the Bayes factor is equal to the ratio of the posterior probabilities of M1 and M2. If instead of the Bayes factor integral, the likelihood corresponding to the maximum likelihood estimate of the parameter for each statistical model is used, then the test becomes a classical likelihood-ratio test. Unlike a likelihood-ratio test, this Bayesian model comparison does not depend on any single set of parameters, as it integrates over all parameters in each model (with respect to the respective priors).  However, an advantage of the use of Bayes factors is that it automatically, and quite naturally, includes a penalty for including too much model structure. It thus guards against overfitting. For models where an explicit version of the likelihood is not available or too costly to evaluate numerically, approximate Bayesian computation can be used for model selection in a Bayesian framework,\nwith the caveat that approximate-Bayesian estimates of Bayes factors are often biased.Other approaches are:\n\nto treat model comparison as a decision problem, computing the expected value or cost of each model choice;\nto use minimum message length (MML).\n\n\n== Interpretation ==\nA value of K > 1 means that M1 is more strongly supported by the data under consideration than M2. Note that classical hypothesis testing gives one hypothesis (or model) preferred status (the 'null hypothesis'), and only considers evidence against it. Harold Jeffreys gave a scale for interpretation of K:\nThe second column gives the corresponding weights of evidence in decihartleys (also known as decibans); bits are added in the third column for clarity.  According to I. J. Good a change in a weight of evidence of 1 deciban or 1/3 of a bit (i.e. a change in an odds ratio from evens to about 5:4) is about as finely as humans can reasonably perceive their degree of belief in a hypothesis in everyday use.An alternative table, widely cited, is provided by Kass and Raftery  (1995):\n\n\n== Example ==\nSuppose we have a random variable that produces either a success or a failure.  We want to compare a model M1 where the probability of success is q = \xbd, and another model M2 where q is unknown and we take a prior distribution for q that is uniform on [0,1].  We take a sample of 200, and find 115 successes and 85 failures.  The likelihood can be calculated according to the binomial distribution:\n\n  \n    \n      \n        \n          \n            \n              \n                (\n              \n              \n                200\n                115\n              \n              \n                )\n              \n            \n          \n          \n            q\n            \n              115\n            \n          \n          (\n          1\n          \u2212\n          q\n          \n            )\n            \n              85\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle {{200 \\choose 115}q^{115}(1-q)^{85}}.}\n  Thus we have for M1\n\n  \n    \n      \n        P\n        (\n        X\n        =\n        115\n        \u2223\n        \n          M\n          \n            1\n          \n        \n        )\n        =\n        \n          \n            \n              (\n            \n            \n              200\n              115\n            \n            \n              )\n            \n          \n        \n        \n          \n            (\n            \n              \n                1\n                2\n              \n            \n            )\n          \n          \n            200\n          \n        \n        =\n        0.005956...\n        ,\n        \n      \n    \n    {\\displaystyle P(X=115\\mid M_{1})={200 \\choose 115}\\left({1 \\over 2}\\right)^{200}=0.005956...,\\,}\n  whereas for M2 we have\n\n  \n    \n      \n        P\n        (\n        X\n        =\n        115\n        \u2223\n        \n          M\n          \n            2\n          \n        \n        )\n        =\n        \n          \u222b\n          \n            0\n          \n          \n            1\n          \n        \n        \n          \n            \n              (\n            \n            \n              200\n              115\n            \n            \n              )\n            \n          \n        \n        \n          q\n          \n            115\n          \n        \n        (\n        1\n        \u2212\n        q\n        \n          )\n          \n            85\n          \n        \n        d\n        q\n        =\n        \n          \n            \n              (\n            \n            \n              200\n              115\n            \n            \n              )\n            \n          \n        \n        \xd7\n        \n          \u222b\n          \n            0\n          \n          \n            1\n          \n        \n        \n          q\n          \n            115\n          \n        \n        (\n        1\n        \u2212\n        q\n        \n          )\n          \n            85\n          \n        \n        d\n        q\n        =\n        \n          \n            \n              (\n            \n            \n              200\n              115\n            \n            \n              )\n            \n          \n        \n        \xd7\n      \n    \n    {\\displaystyle P(X=115\\mid M_{2})=\\int _{0}^{1}{200 \\choose 115}q^{115}(1-q)^{85}dq={200 \\choose 115}\\times \\int _{0}^{1}q^{115}(1-q)^{85}dq={200 \\choose 115}\\times }\n   \n  \n    \n      \n        \n          B\n        \n        (\n        116\n        ,\n        86\n        )\n      \n    \n    {\\displaystyle \\mathrm {B} (116,86)}\n   \n  \n    \n      \n        =\n        \n          \n            \n              (\n            \n            \n              200\n              115\n            \n            \n              )\n            \n          \n        \n        \xd7\n      \n    \n    {\\displaystyle ={200 \\choose 115}\\times }\n   \n  \n    \n      \n        \n          \u0393\n          (\n          116\n          )\n          \xd7\n          \u0393\n          (\n          86\n          )\n        \n        \n          \u0393\n          (\n          116\n          +\n          86\n          )\n        \n      \n    \n    {\\displaystyle \\Gamma (116)\\times \\Gamma (86) \\over \\Gamma (116+86)}\n   \n  \n    \n      \n        =\n        \n          \n            \n              200\n              !\n            \n            \n              \n                115\n                !\n              \n              \xd7\n              \n                85\n                !\n              \n            \n          \n        \n        \xd7\n        \n          \n            \n              \n                115\n                !\n              \n              \xd7\n              \n                85\n                !\n              \n            \n            \n              201\n              !\n            \n          \n        \n        =\n        \n          \n            1\n            201\n          \n        \n        =\n        0.004975....\n      \n    \n    {\\displaystyle ={\\frac {200!}{{115!}\\times {85!}}}\\times {\\frac {{115!}\\times {85!}}{201!}}={1 \\over 201}=0.004975....}\n  The ratio is then 1.197..., which is "barely worth mentioning" even if it points very slightly towards M1.\nA frequentist hypothesis test of M1 (here considered as a null hypothesis) would have produced a very different result.  Such a test says that M1 should be rejected at the 5% significance level, since the probability of getting 115 or more successes from a sample of 200 if q = \xbd is 0.0200, and as a two-tailed test of getting a figure as extreme as or more extreme than 115 is 0.0400.  Note that 115 is more than two standard deviations away from 100. Thus, whereas a frequentist hypothesis test would yield significant results at the 5% significance level, the Bayes factor hardly considers this to be an extreme result. Note, however, that a non-uniform prior (for example one that reflects the fact that you expect the number of success and failures to be of the same order of magnitude) could result in a Bayes factor that is more in agreement with the frequentist hypothesis test.\nA classical likelihood-ratio test would have found the maximum likelihood estimate for q, namely 115\u2044200 = 0.575, whence \n\n  \n    \n      \n        \n          P\n          (\n          X\n          =\n          115\n          \u2223\n          \n            M\n            \n              2\n            \n          \n          )\n          =\n          \n            \n              \n                \n                  (\n                \n                \n                  200\n                  115\n                \n                \n                  )\n                \n              \n            \n            \n              q\n              \n                115\n              \n            \n            (\n            1\n            \u2212\n            q\n            \n              )\n              \n                85\n              \n            \n          \n          =\n          0.056991\n        \n      \n    \n    {\\displaystyle \\textstyle P(X=115\\mid M_{2})={{200 \\choose 115}q^{115}(1-q)^{85}}=0.056991}\n  (rather than averaging over all possible q).  That gives a likelihood ratio of 0.1045 and points towards M2.\nM2 is a more complex model than M1 because it has a free parameter which allows it to model the data more closely.  The ability of Bayes factors to take this into account is a reason why Bayesian inference has been put forward as a theoretical justification for and generalisation of Occam's razor, reducing Type I errors.On the other hand, the modern method of relative likelihood takes into account the number of free parameters in the models, unlike the classical likelihood ratio.  The relative likelihood method could be applied as follows.  Model M1 has 0 parameters, and so its AIC value is 2\xb70 \u2212 2\xb7ln(0.005956) = 10.2467.  Model M2 has 1 parameter, and so its AIC value is 2\xb71 \u2212 2\xb7ln(0.056991) = 7.7297.  Hence M1 is about exp((7.7297 \u2212 10.2467)/2) = 0.284 times as probable as M2 to minimize the information loss.  Thus M2 is slightly preferred, but M1 cannot be excluded.\n\n\n== Application ==\nBayes factor has been applied to rank dynamic differential expression of genes instead of q-value.\n\n\n== See also ==\n\nAkaike information criterion\nApproximate Bayesian computation\nBayesian information criterion\nDeviance information criterion\nLindley's paradox\nMinimum message length\nModel selectionStatistical ratiosOdds ratio\nRelative risk\n\n\n== References ==\n\n\n== Further reading ==\nBernardo, J.; Smith, A. F. M. (1994). Bayesian Theory. John Wiley. ISBN 0-471-92416-4.\nDenison, D. G. T.; Holmes, C. C.; Mallick, B. K.; Smith, A. F. M. (2002). Bayesian Methods for Nonlinear Classification and Regression. John Wiley. ISBN 0-471-49036-9.\nDienes, Z. (2019). How do I know what my theory predicts? Advances in Methods and Practices in Psychological Science https://doi.org/10.1177/2515245919876960\nDuda, Richard O.; Hart, Peter E.; Stork, David G. (2000). "Section 9.6.5". Pattern classification (2nd ed.). Wiley. pp. 487\u2013489. ISBN 0-471-05669-3.\nGelman, A.; Carlin, J.; Stern, H.; Rubin, D. (1995). Bayesian Data Analysis. London: Chapman & Hall. ISBN 0-412-03991-5.\nJaynes, E. T. (1994), Probability Theory: the logic of science, chapter 24.\nLee, P. M. (2012). Bayesian Statistics: an introduction. Wiley. ISBN 9781118332573.\nWinkler, Robert (2003). Introduction to Bayesian Inference and Decision (2nd ed.). Probabilistic. ISBN 0-9647938-4-9.\n\n\n== External links ==\nBayesFactor \u2014an R package for computing Bayes factors in common research designs\nBayes factor calculator \u2014 Online calculator for informed Bayes factors\nBayes Factor Calculators \u2014web-based version of much of the BayesFactor package