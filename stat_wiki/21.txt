In Bayesian statistics, a maximum a posteriori probability (MAP) estimate is an estimate of an unknown quantity, that equals the mode of the posterior distribution. The MAP can be used to obtain a point estimate of an unobserved quantity on the basis of empirical data. It is closely related to the method of maximum likelihood (ML) estimation, but employs an augmented optimization objective which incorporates a prior distribution (that quantifies the additional information available through prior knowledge of a related event) over the quantity one wants to estimate.  MAP estimation can therefore be seen as a regularization of ML estimation.\n\n\n== Description ==\nAssume that we want to estimate an unobserved population parameter \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   on the basis of observations \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  . Let \n  \n    \n      \n        f\n      \n    \n    {\\displaystyle f}\n   be the sampling distribution of \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  , so that \n  \n    \n      \n        f\n        (\n        x\n        \u2223\n        \u03b8\n        )\n      \n    \n    {\\displaystyle f(x\\mid \\theta )}\n   is the probability of \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n   when the underlying population parameter is \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n  .  Then the function:\n\n  \n    \n      \n        \u03b8\n        \u21a6\n        f\n        (\n        x\n        \u2223\n        \u03b8\n        )\n        \n      \n    \n    {\\displaystyle \\theta \\mapsto f(x\\mid \\theta )\\!}\n  is known as the likelihood function and the estimate:\n\n  \n    \n      \n        \n          \n            \n              \n                \u03b8\n                ^\n              \n            \n          \n          \n            \n              M\n              L\n              E\n            \n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            \n              a\n              r\n              g\n              \n              m\n              a\n              x\n            \n            \u03b8\n          \n        \n         \n        f\n        (\n        x\n        \u2223\n        \u03b8\n        )\n        \n      \n    \n    {\\displaystyle {\\hat {\\theta }}_{\\mathrm {MLE} }(x)={\\underset {\\theta }{\\operatorname {arg\\,max} }}\\ f(x\\mid \\theta )\\!}\n  is the maximum likelihood estimate of \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n  .\nNow assume that a prior distribution \n  \n    \n      \n        g\n      \n    \n    {\\displaystyle g}\n   over \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   exists.  This allows us to treat \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   as a random variable as in Bayesian statistics.  We can calculate the posterior distribution of \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   using Bayes' theorem:\n\n  \n    \n      \n        \u03b8\n        \u21a6\n        f\n        (\n        \u03b8\n        \u2223\n        x\n        )\n        =\n        \n          \n            \n              f\n              (\n              x\n              \u2223\n              \u03b8\n              )\n              \n              g\n              (\n              \u03b8\n              )\n            \n            \n              \n                \u222b\n                \n                  \u0398\n                \n              \n              f\n              (\n              x\n              \u2223\n              \u03d1\n              )\n              \n              g\n              (\n              \u03d1\n              )\n              \n              d\n              \u03d1\n            \n          \n        \n        \n      \n    \n    {\\displaystyle \\theta \\mapsto f(\\theta \\mid x)={\\frac {f(x\\mid \\theta )\\,g(\\theta )}{\\displaystyle \\int _{\\Theta }f(x\\mid \\vartheta )\\,g(\\vartheta )\\,d\\vartheta }}\\!}\n  where \n  \n    \n      \n        g\n      \n    \n    {\\displaystyle g}\n   is density function of \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n  , \n  \n    \n      \n        \u0398\n      \n    \n    {\\displaystyle \\Theta }\n   is the domain of \n  \n    \n      \n        g\n      \n    \n    {\\displaystyle g}\n  .\nThe method of maximum a posteriori estimation then estimates \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   as the mode of the posterior distribution of this random variable:\n\n  \n    \n      \n        \n          \n            \n              \n                \u03b8\n                ^\n              \n            \n          \n          \n            \n              M\n              A\n              P\n            \n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            \n              a\n              r\n              g\n              \n              m\n              a\n              x\n            \n            \u03b8\n          \n        \n         \n        f\n        (\n        \u03b8\n        \u2223\n        x\n        )\n        =\n        \n          \n            \n              a\n              r\n              g\n              \n              m\n              a\n              x\n            \n            \u03b8\n          \n        \n         \n        \n          \n            \n              f\n              (\n              x\n              \u2223\n              \u03b8\n              )\n              \n              g\n              (\n              \u03b8\n              )\n            \n            \n              \n                \u222b\n                \n                  \u0398\n                \n              \n              f\n              (\n              x\n              \u2223\n              \u03d1\n              )\n              \n              g\n              (\n              \u03d1\n              )\n              \n              d\n              \u03d1\n            \n          \n        \n        =\n        \n          \n            \n              a\n              r\n              g\n              \n              m\n              a\n              x\n            \n            \u03b8\n          \n        \n         \n        f\n        (\n        x\n        \u2223\n        \u03b8\n        )\n        \n        g\n        (\n        \u03b8\n        )\n        .\n        \n      \n    \n    {\\displaystyle {\\hat {\\theta }}_{\\mathrm {MAP} }(x)={\\underset {\\theta }{\\operatorname {arg\\,max} }}\\ f(\\theta \\mid x)={\\underset {\\theta }{\\operatorname {arg\\,max} }}\\ {\\frac {f(x\\mid \\theta )\\,g(\\theta )}{\\displaystyle \\int _{\\Theta }f(x\\mid \\vartheta )\\,g(\\vartheta )\\,d\\vartheta }}={\\underset {\\theta }{\\operatorname {arg\\,max} }}\\ f(x\\mid \\theta )\\,g(\\theta ).\\!}\n  The denominator of the posterior distribution (so-called marginal likelihood) is always positive and does not depend on \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   and therefore plays no role in the optimization. Observe that the MAP estimate of \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   coincides with the ML estimate when the prior \n  \n    \n      \n        g\n      \n    \n    {\\displaystyle g}\n   is uniform (that is, a constant function).\nWhen the loss function is of the form\n\n  \n    \n      \n        L\n        (\n        \u03b8\n        ,\n        a\n        )\n        =\n        \n          \n            {\n            \n              \n                \n                  0\n                  ,\n                \n                \n                  \n                    if \n                  \n                  \n                    |\n                  \n                  a\n                  \u2212\n                  \u03b8\n                  \n                    |\n                  \n                  <\n                  c\n                  ,\n                \n              \n              \n                \n                  1\n                  ,\n                \n                \n                  \n                    otherwise\n                  \n                  ,\n                \n              \n            \n            \n          \n        \n      \n    \n    {\\displaystyle L(\\theta ,a)={\\begin{cases}0,&{\\text{if }}|a-\\theta |<c,\\\\1,&{\\text{otherwise}},\\\\\\end{cases}}}\n  as \n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n   goes to 0, the Bayes estimator approaches the MAP estimator, provided that the distribution of \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   is quasi-concave. But generally a MAP estimator is not a Bayes estimator unless \n  \n    \n      \n        \u03b8\n      \n    \n    {\\displaystyle \\theta }\n   is discrete.\n\n\n== Computation ==\nMAP estimates can be computed in several ways:\n\nAnalytically, when the mode(s) of the posterior distribution can be given in closed form.  This is the case when conjugate priors are used.\nVia numerical optimization such as the conjugate gradient method or Newton's method. This usually requires first or second derivatives, which have to be evaluated analytically or numerically.\nVia a modification of an expectation-maximization algorithm. This does not require derivatives of the posterior density.\nVia a Monte Carlo method using simulated annealing\n\n\n== Limitations ==\nWhile only mild conditions  are required for MAP estimation to be a limiting case of Bayes estimation (under the 0\u20131 loss function), it is not very representative of Bayesian methods in general.  This is because MAP estimates are point estimates, whereas Bayesian methods are characterized by the use of distributions to summarize data and draw inferences: thus, Bayesian methods tend to report the posterior mean or median instead, together with credible intervals.  This is both because these estimators are optimal under squared-error and linear-error loss respectively\u2014which are more representative of typical loss functions\u2014and because the posterior distribution may not have a simple analytic form: in this case, the distribution can be simulated using Markov chain Monte Carlo techniques, while optimization to find its mode(s) may be difficult or impossible.\n\nIn many types of models, such as mixture models, the posterior may be multi-modal. In such a case, the usual recommendation is that one should choose the highest mode: this is not always feasible (global optimization is a difficult problem), nor in some cases even possible (such as when identifiability issues arise). Furthermore, the highest mode may be uncharacteristic of the majority of the posterior.\nFinally, unlike ML estimators, the MAP estimate is not invariant under reparameterization. Switching from one parameterization to another involves introducing a Jacobian that impacts on the location of the maximum.As an example of the difference between Bayes estimators mentioned above (mean and median estimators) and using a MAP estimate, consider the case where there is a  need to classify inputs \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n   as either positive or negative (for example, loans as risky or safe). Suppose there are just three possible hypotheses about the correct method of classification \n  \n    \n      \n        \n          h\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle h_{1}}\n  , \n  \n    \n      \n        \n          h\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle h_{2}}\n   and \n  \n    \n      \n        \n          h\n          \n            3\n          \n        \n      \n    \n    {\\displaystyle h_{3}}\n   with posteriors 0.4, 0.3 and 0.3 respectively. Suppose given a new instance, \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  , \n  \n    \n      \n        \n          h\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle h_{1}}\n   classifies it as positive, whereas the other two classify it as negative. Using the MAP estimate for the correct classifier \n  \n    \n      \n        \n          h\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle h_{1}}\n  , \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n   is classified as positive, whereas the Bayes estimators would average over all hypotheses and classify \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n   as negative.\n\n\n== Example ==\nSuppose that we are given a sequence \n  \n    \n      \n        (\n        \n          x\n          \n            1\n          \n        \n        ,\n        \u2026\n        ,\n        \n          x\n          \n            n\n          \n        \n        )\n      \n    \n    {\\displaystyle (x_{1},\\dots ,x_{n})}\n   of IID \n  \n    \n      \n        N\n        (\n        \u03bc\n        ,\n        \n          \u03c3\n          \n            v\n          \n          \n            2\n          \n        \n        )\n      \n    \n    {\\displaystyle N(\\mu ,\\sigma _{v}^{2})}\n   random variables and a priori distribution of \n  \n    \n      \n        \u03bc\n      \n    \n    {\\displaystyle \\mu }\n   is given by  \n  \n    \n      \n        N\n        (\n        \n          \u03bc\n          \n            0\n          \n        \n        ,\n        \n          \u03c3\n          \n            m\n          \n          \n            2\n          \n        \n        )\n      \n    \n    {\\displaystyle N(\\mu _{0},\\sigma _{m}^{2})}\n  .  We wish to find the MAP estimate of \n  \n    \n      \n        \u03bc\n      \n    \n    {\\displaystyle \\mu }\n  . Note that the normal distribution is its own conjugate prior, so we will be able to find a closed-form solution analytically.\nThe function to be maximized is then given by\n\n  \n    \n      \n        f\n        (\n        \u03bc\n        )\n        f\n        (\n        x\n        \u2223\n        \u03bc\n        )\n        =\n        \u03c0\n        (\n        \u03bc\n        )\n        L\n        (\n        \u03bc\n        )\n        =\n        \n          \n            1\n            \n              \n                \n                  2\n                  \u03c0\n                \n              \n              \n                \u03c3\n                \n                  m\n                \n              \n            \n          \n        \n        exp\n        \u2061\n        \n          (\n          \n            \u2212\n            \n              \n                1\n                2\n              \n            \n            \n              \n                (\n                \n                  \n                    \n                      \u03bc\n                      \u2212\n                      \n                        \u03bc\n                        \n                          0\n                        \n                      \n                    \n                    \n                      \u03c3\n                      \n                        m\n                      \n                    \n                  \n                \n                )\n              \n              \n                2\n              \n            \n          \n          )\n        \n        \n          \u220f\n          \n            j\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          \n            1\n            \n              \n                \n                  2\n                  \u03c0\n                \n              \n              \n                \u03c3\n                \n                  v\n                \n              \n            \n          \n        \n        exp\n        \u2061\n        \n          (\n          \n            \u2212\n            \n              \n                1\n                2\n              \n            \n            \n              \n                (\n                \n                  \n                    \n                      \n                        x\n                        \n                          j\n                        \n                      \n                      \u2212\n                      \u03bc\n                    \n                    \n                      \u03c3\n                      \n                        v\n                      \n                    \n                  \n                \n                )\n              \n              \n                2\n              \n            \n          \n          )\n        \n        ,\n      \n    \n    {\\displaystyle f(\\mu )f(x\\mid \\mu )=\\pi (\\mu )L(\\mu )={\\frac {1}{{\\sqrt {2\\pi }}\\sigma _{m}}}\\exp \\left(-{\\frac {1}{2}}\\left({\\frac {\\mu -\\mu _{0}}{\\sigma _{m}}}\\right)^{2}\\right)\\prod _{j=1}^{n}{\\frac {1}{{\\sqrt {2\\pi }}\\sigma _{v}}}\\exp \\left(-{\\frac {1}{2}}\\left({\\frac {x_{j}-\\mu }{\\sigma _{v}}}\\right)^{2}\\right),}\n  which is equivalent to minimizing the following function of \n  \n    \n      \n        \u03bc\n      \n    \n    {\\displaystyle \\mu }\n  :\n\n  \n    \n      \n        \n          \u2211\n          \n            j\n            =\n            1\n          \n          \n            n\n          \n        \n        \n          \n            (\n            \n              \n                \n                  \n                    x\n                    \n                      j\n                    \n                  \n                  \u2212\n                  \u03bc\n                \n                \n                  \u03c3\n                  \n                    v\n                  \n                \n              \n            \n            )\n          \n          \n            2\n          \n        \n        +\n        \n          \n            (\n            \n              \n                \n                  \u03bc\n                  \u2212\n                  \n                    \u03bc\n                    \n                      0\n                    \n                  \n                \n                \n                  \u03c3\n                  \n                    m\n                  \n                \n              \n            \n            )\n          \n          \n            2\n          \n        \n        .\n      \n    \n    {\\displaystyle \\sum _{j=1}^{n}\\left({\\frac {x_{j}-\\mu }{\\sigma _{v}}}\\right)^{2}+\\left({\\frac {\\mu -\\mu _{0}}{\\sigma _{m}}}\\right)^{2}.}\n  Thus, we see that the MAP estimator for \u03bc is given by\n\n  \n    \n      \n        \n          \n            \n              \n                \u03bc\n                ^\n              \n            \n          \n          \n            \n              M\n              A\n              P\n            \n          \n        \n        =\n        \n          \n            \n              \n                \u03c3\n                \n                  m\n                \n                \n                  2\n                \n              \n              \n              n\n            \n            \n              \n                \u03c3\n                \n                  m\n                \n                \n                  2\n                \n              \n              \n              n\n              +\n              \n                \u03c3\n                \n                  v\n                \n                \n                  2\n                \n              \n            \n          \n        \n        \n          (\n          \n            \n              \n                1\n                n\n              \n            \n            \n              \u2211\n              \n                j\n                =\n                1\n              \n              \n                n\n              \n            \n            \n              x\n              \n                j\n              \n            \n          \n          )\n        \n        +\n        \n          \n            \n              \u03c3\n              \n                v\n              \n              \n                2\n              \n            \n            \n              \n                \u03c3\n                \n                  m\n                \n                \n                  2\n                \n              \n              \n              n\n              +\n              \n                \u03c3\n                \n                  v\n                \n                \n                  2\n                \n              \n            \n          \n        \n        \n        \n          \u03bc\n          \n            0\n          \n        \n        =\n        \n          \n            \n              \n                \u03c3\n                \n                  m\n                \n                \n                  2\n                \n              \n              \n                (\n                \n                  \n                    \u2211\n                    \n                      j\n                      =\n                      1\n                    \n                    \n                      n\n                    \n                  \n                  \n                    x\n                    \n                      j\n                    \n                  \n                \n                )\n              \n              +\n              \n                \u03c3\n                \n                  v\n                \n                \n                  2\n                \n              \n              \n              \n                \u03bc\n                \n                  0\n                \n              \n            \n            \n              \n                \u03c3\n                \n                  m\n                \n                \n                  2\n                \n              \n              \n              n\n              +\n              \n                \u03c3\n                \n                  v\n                \n                \n                  2\n                \n              \n            \n          \n        \n        .\n      \n    \n    {\\displaystyle {\\hat {\\mu }}_{\\mathrm {MAP} }={\\frac {\\sigma _{m}^{2}\\,n}{\\sigma _{m}^{2}\\,n+\\sigma _{v}^{2}}}\\left({\\frac {1}{n}}\\sum _{j=1}^{n}x_{j}\\right)+{\\frac {\\sigma _{v}^{2}}{\\sigma _{m}^{2}\\,n+\\sigma _{v}^{2}}}\\,\\mu _{0}={\\frac {\\sigma _{m}^{2}\\left(\\sum _{j=1}^{n}x_{j}\\right)+\\sigma _{v}^{2}\\,\\mu _{0}}{\\sigma _{m}^{2}\\,n+\\sigma _{v}^{2}}}.}\n  which turns out to be a linear interpolation between the prior mean and the sample mean weighted by their respective covariances.\nThe case of \n  \n    \n      \n        \n          \u03c3\n          \n            m\n          \n        \n        \u2192\n        \u221e\n      \n    \n    {\\displaystyle \\sigma _{m}\\to \\infty }\n   is called a non-informative prior and leads to an ill-defined a priori probability distribution; in this case \n  \n    \n      \n        \n          \n            \n              \n                \u03bc\n                ^\n              \n            \n          \n          \n            \n              M\n              A\n              P\n            \n          \n        \n        \u2192\n        \n          \n            \n              \n                \u03bc\n                ^\n              \n            \n          \n          \n            \n              M\n              L\n            \n          \n        \n        .\n      \n    \n    {\\displaystyle {\\hat {\\mu }}_{\\mathrm {MAP} }\\to {\\hat {\\mu }}_{\\mathrm {ML} }.}\n  \n\n\n== References ==\n\nDeGroot, M. (1970). Optimal Statistical Decisions. McGraw-Hill. ISBN 0-07-016242-5.\nSorenson, Harold W. (1980). Parameter Estimation: Principles and Problems. Marcel Dekker. ISBN 0-8247-6987-2.\nHald, Anders (2007). "Gauss's Derivation of the Normal Distribution and the Method of Least Squares, 1809". A History of Parametric Statistical Inference from Bernoulli to Fisher, 1713\u20131935. New York: Springer. pp. 55\u201361. ISBN 978-0-387-46409-1.